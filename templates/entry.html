{% extends "layout.html" %}

{% block title %}
    New_Entry
{% endblock %}

{% block main %}
<div class='container-xl'>
    <div class="row align-items-start">
        <div class="col">
            <form method=POST action="/entry">
                <label for="specimen"><b>Specimen Type:</b></label>
                <select name="specimen" id="specimen">
                    {% for x in specimens %}
                        <option value='{{ x.specimen }}'>{{ x.specimen }}</option>
                    {% endfor %}
                    <option value='new'>New Specimen</option>
                </select> 
                <input type="submit" value="Confirm">
            </form>
        </div>
        <div class="col">
            <b>Checklist:</b>
            <div id="checklist">
                <input type="checkbox" value="1" id="1"/><label for="1">Default 1</label>   
            </div>          
        </div>
        <div class="col -md-4 ms-auto">
            <input type="submit" value="Save and Exit">
            <input type="submit" value="Save">
            <input type="submit" value="Export">
        </div>
    </div>

    <br><br>
    <br><br>

    <div class="row align-items-start">
        <div class="col">
            <textarea id="w3review" name="w3review" rows="8" cols="70">
            </textarea>
            <br><br>
        </div>
        <div class="col">
            <p><b>Upload Image:</b></p>
            <input type="file" value="image">
        </div>
    </div>
</div>
{% endblock %}

{% block script %}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // identify specimen dropdown
            let specimen = document.querySelector('#specimen');

            // see specimen change
            specimen.addEventListener('change', function() {
                // find checklist for new specimen
                let s = specimen.value;
                let temp = {{ specimens|tojson }};
                var x = [];
                for(var i = 0; i < temp.length; i++){
                    if (temp[i].specimen == s){
                        x = temp[i].checklist;
                    }  
                }
                
                let container = $(document.querySelector('#checklist'));
                // remove current checklist items
                container.empty();

                // add new list items
                for(var i = 0; i < x.length; i++){
                    $('<input />', { type: 'checkbox', id: i, value: x[i] }).appendTo(container);
                    $('<label />', { 'for': i, text: x[i] }).appendTo(container);
                    $('<br>').appendTo(container)
                }
            });
        });

    </script>
{% endblock %}